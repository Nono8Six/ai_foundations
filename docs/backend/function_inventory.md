This file tracks all stored procedures and trigger functions in the project. Use this as a reference to ensure each function is version controlled.

| Function                                                  | Status  | Location                                                                                         | Notes                                  |
| --------------------------------------------------------- | ------- | ------------------------------------------------------------------------------------------------ | -------------------------------------- |
| `create_default_profile()`                                | Tracked | `supabase/functions/create_default_profile.sql` and migration `20250615202948_remote_schema.sql` | Trigger for new users                  |
| `create_user_settings()`                                  | Tracked | `supabase/functions/create_user_settings.sql` and migration `20250615202948_remote_schema.sql`   | Trigger for profile creation           |
| `current_user_is_admin()`                                 | Tracked | `supabase/functions/current_user_is_admin.sql` and migration `20250615202948_remote_schema.sql`  | Checks if the current user is admin    |
| `email_exists(text)`                                      | Tracked | `supabase/functions/email_exists.sql` and migration `20250615202948_remote_schema.sql`           | Helper restricted to `service_role`    |
| `get_user_settings(uuid)`                                 | Tracked | `supabase/functions/get_user_settings.sql` and migration `20250615202948_remote_schema.sql`      | Returns settings for a user            |
| `handle_updated_at()`                                     | Tracked | `supabase/functions/handle_updated_at.sql` and migration `20250615202948_remote_schema.sql`      | Generic updated_at trigger             |
| `update_user_profile(profile_data jsonb, user_id uuid)`   | Tracked | `supabase/functions/update_user_profile.sql` and migration `20250615202948_remote_schema.sql`    | Main profile update function           |
| `update_user_settings(settings_data jsonb, user_id uuid)` | Tracked | `supabase/functions/update_user_settings.sql` and migration `20250615202948_remote_schema.sql`   | Main settings update function          |
| `get_course_stats()`                                      | Dropped | –                                                                                                | Not referenced in code                 |
| `get_user_settings_rpc()`                                 | Dropped | –                                                                                                | Deprecated                             |
| `get_user_stats()`                                        | Dropped | –                                                                                                | Not referenced in code                 |
| `handle_lesson_completion(uuid, uuid)`                    | Dropped | –                                                                                                | Unused                                 |
| `handle_new_user()`                                       | Dropped | –                                                                                                | Replaced by `create_default_profile()` |
| `handle_user_notes_updated_at()`                          | Dropped | –                                                                                                | Not implemented                        |
| `is_admin()`                                              | Removed | –                                                                                                | Replaced by `profiles.is_admin` column |
| `is_admin(uuid)`                                          | Dropped | –                                                                                                | Unused                                 |
| `test_auth_rpc()`                                         | Dropped | –                                                                                                | Development helper                     |
| `test_rpc()`                                              | Dropped | –                                                                                                | Development helper                     |
| `test_with_hardcoded_id()`                                | Dropped | –                                                                                                | Development helper                     |
| `update_user_profile(profile_data jsonb)`                 | Dropped | –                                                                                                | Legacy version                         |
| `update_user_settings(uuid, jsonb, jsonb, jsonb)`         | Dropped | –                                                                                                | Alternative signature not used         |
| `update_user_settings_rpc(settings_data jsonb)`           | Dropped | –                                                                                                | Deprecated                             |
