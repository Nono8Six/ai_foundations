{
  "description": "EXPLAIN ANALYZE collection",
  "exitCode": 0,
  "timestamp": "2025-08-17T17:13:31.486Z",
  "stdout": "üìã P10: Collecting EXPLAIN ANALYZE for key RPC functions...\r\nüîç Analyzing credit_xp function...\r\n=====================================;\r\n                                                                              QUERY PLAN                                                                               \r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Result  (cost=0.00..0.26 rows=1 width=32) (actual time=0.987..0.988 rows=1 loops=1)\r\n   Output: credit_xp('00000000-0000-0000-0000-000000000001'::uuid, 'lesson:completion'::text, 50, 'explain-credit-xp-test'::text, NULL::uuid, NULL::text, '{}'::jsonb)\r\n   Buffers: shared hit=345\r\n Query Identifier: -2722577134236380289\r\n Planning Time: 0.024 ms\r\n Execution Time: 1.003 ms\r\n(6 rows)\r\n\r\n;\r\nüîç Analyzing get_active_xp_sources function...\r\n==============================================;\r\n                                         QUERY PLAN                                          \r\n---------------------------------------------------------------------------------------------\r\n ProjectSet  (cost=0.00..5.27 rows=1000 width=32) (actual time=0.200..0.229 rows=24 loops=1)\r\n   Output: get_active_xp_sources(now())\r\n   Buffers: shared hit=2\r\n   ->  Result  (cost=0.00..0.01 rows=1 width=0) (actual time=0.001..0.002 rows=1 loops=1)\r\n Query Identifier: -1125711535403011146\r\n Planning Time: 0.025 ms\r\n Execution Time: 0.256 ms\r\n(7 rows)\r\n\r\n;\r\nüîç Analyzing compute_level_info function...\r\n===========================================;\r\n                                         QUERY PLAN                                         \r\n--------------------------------------------------------------------------------------------\r\n ProjectSet  (cost=0.00..5.27 rows=1000 width=32) (actual time=0.325..0.331 rows=1 loops=1)\r\n   Output: compute_level_info(150)\r\n   Buffers: shared hit=4\r\n   ->  Result  (cost=0.00..0.01 rows=1 width=0) (actual time=0.001..0.001 rows=1 loops=1)\r\n Query Identifier: -6337873644889589703\r\n Planning Time: 0.023 ms\r\n Execution Time: 0.355 ms\r\n(7 rows)\r\n\r\n;\r\nüîç Skipping unlock_achievement analysis (schema mismatch issue)...\r\n====================================================================;\r\n;\r\nüìä Index Usage Analysis;\r\n========================;\r\n schemaname |     tablename     |                            indexname                            | scans | tuples_read | tuples_fetched \r\n------------+-------------------+-----------------------------------------------------------------+-------+-------------+----------------\r\n public     | level_definitions | ix_level_definitions_level_xp_required                          |  3077 |        3078 |           3077\r\n public     | level_definitions | level_definitions_pkey                                          |   164 |         684 |            684\r\n public     | level_definitions | idx_level_definitions_xp_required                               |     0 |           0 |              0\r\n public     | level_definitions | uq_xp_required                                                  |     0 |           0 |              0\r\n public     | level_definitions | uq_level                                                        |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_user_id                                            |  2050 |      109418 |           2046\r\n public     | profiles          | profiles_pkey                                                   |   151 |         431 |            118\r\n public     | profiles          | idx_profiles_created_at                                         |    64 |          64 |             64\r\n public     | profiles          | profiles_email_key                                              |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_admin                                              |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_xp_level                                           |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_email                                              |     0 |           0 |              0\r\n public     | user_achievements | idx_user_achievements_user_id                                   |     6 |          19 |             17\r\n public     | user_achievements | user_achievements_pkey                                          |     2 |           0 |              0\r\n public     | user_achievements | user_achievements_user_id_achievement_type_achievement_name_key |     0 |           0 |              0\r\n public     | user_achievements | ux_ua_user_ach_ver_scope                                        |     0 |           0 |              0\r\n public     | user_achievements | idx_user_achievements_user_type                                 |     0 |           0 |              0\r\n public     | user_achievements | idx_user_achievements_type                                      |     0 |           0 |              0\r\n public     | xp_events         | uk_xp_events_idempotency                                        |  1636 |         830 |            234\r\n public     | xp_events         | xp_events_pkey                                                  |    16 |          26 |             16\r\n public     | xp_events         | idx_xp_events_user_aggregates                                   |     2 |           2 |              0\r\n public     | xp_events         | idx_xp_events_user_created                                      |     1 |         174 |            162\r\n public     | xp_events         | idx_xp_events_source_stats                                      |     0 |           0 |              0\r\n public     | xp_events         | idx_xp_events_source_type                                       |     0 |           0 |              0\r\n public     | xp_events         | idx_xp_events_created_at                                        |     0 |           0 |              0\r\n public     | xp_sources        | uq_xp_sources_type_action_version                               |   104 |         100 |             96\r\n public     | xp_sources        | ex_xp_sources_active_overlap                                    |     6 |          24 |              4\r\n public     | xp_sources        | xp_sources_pkey                                                 |     5 |          36 |             36\r\n public     | xp_sources        | idx_xp_sources_active_type                                      |     3 |          30 |             20\r\n public     | xp_sources        | idx_xp_sources_active                                           |     0 |           0 |              0\r\n(30 rows)\r\n\r\n;\r\nüìä Table Statistics;\r\n===================;\r\n schemaname |     tablename     | seq_scan | seq_tup_read | idx_scan | idx_tup_fetch | inserts | updates | deletes | live_tuples | dead_tuples \r\n------------+-------------------+----------+--------------+----------+---------------+---------+---------+---------+-------------+-------------\r\n public     | level_definitions |     3105 |        43465 |     3241 |          3761 |      15 |      10 |       0 |          14 |          11\r\n public     | profiles          |    25603 |        26617 |     2265 |          2228 |      20 |    1659 |       0 |           5 |         163\r\n public     | user_achievements |     2345 |         6899 |        8 |            17 |      11 |       4 |       3 |           3 |          12\r\n public     | xp_events         |     3559 |        18868 |     1655 |           414 |    1432 |      15 |    1139 |         170 |         163\r\n public     | xp_sources        |     1264 |         9416 |      118 |           156 |      47 |     178 |      22 |          24 |           6\r\n(5 rows)\r\n\r\n;\r\nüîß Query Plan Cache Stats;\r\n==========================;\r\n funcname | calls | total_time | mean_time | self_time \r\n----------+-------+------------+-----------+-----------\r\n(0 rows)\r\n\r\n;\r\nüíæ Buffer Cache Analysis;\r\n========================;\r\n      relname      |  size  | heap_read | heap_hit | cache_hit_ratio \r\n-------------------+--------+-----------+----------+-----------------\r\n level_definitions | 96 kB  |         0 |     6392 |          100.00\r\n profiles          | 328 kB |         1 |   221443 |          100.00\r\n user_achievements | 112 kB |         0 |     2347 |          100.00\r\n xp_events         | 336 kB |         0 |    10578 |          100.00\r\n xp_sources        | 128 kB |         0 |     3353 |          100.00\r\n(5 rows)\r\n\r\n;\r\nüîí Lock Analysis;\r\n================;\r\n pid | locktype | mode | granted | table_name \r\n-----+----------+------+---------+------------\r\n(0 rows)\r\n\r\n;\r\n‚ö° Performance Recommendations;\r\n==============================;\r\nDO\r\n;\r\n‚úÖ P10: EXPLAIN ANALYZE collection completed;\r\n   - Execution plans captured for all key RPC functions;\r\n   - Index usage patterns analyzed;\r\n   - Buffer cache effectiveness measured;\r\n   - Performance recommendations generated;\r\n",
  "stderr": "psql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  Performance Recommendations:\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: profiles_email_key on profiles (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_profiles_email on profiles (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_profiles_xp_level on profiles (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_profiles_admin on profiles (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_xp_events_source_type on xp_events (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_xp_events_source_stats on xp_events (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_xp_events_created_at on xp_events (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: uq_level on level_definitions (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: uq_xp_required on level_definitions (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_level_definitions_xp_required on level_definitions (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: user_achievements_user_id_achievement_type_achievement_name_key on user_achievements (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_user_achievements_type on user_achievements (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_user_achievements_user_type on user_achievements (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: ux_ua_user_ach_ver_scope on user_achievements (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üìã Unused index detected: idx_xp_sources_active on xp_sources (consider dropping)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üîç High sequential scan ratio for profiles: 91.87%% (consider adding indexes)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üîç High sequential scan ratio for xp_sources: 91.46%% (consider adding indexes)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üîç High sequential scan ratio for user_achievements: 99.66%% (consider adding indexes)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üîç High sequential scan ratio for xp_events: 68.26%% (consider adding indexes)\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:208: NOTICE:  üîç High sequential scan ratio for level_definitions: 48.93%% (consider adding indexes)\r\n"
}