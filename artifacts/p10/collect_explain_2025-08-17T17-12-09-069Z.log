{
  "description": "EXPLAIN ANALYZE collection",
  "exitCode": 3,
  "timestamp": "2025-08-17T17:12:09.069Z",
  "stdout": "📋 P10: Collecting EXPLAIN ANALYZE for key RPC functions...\r\n🔍 Analyzing credit_xp function...\r\n=====================================;\r\n                                                                              QUERY PLAN                                                                               \r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Result  (cost=0.00..0.26 rows=1 width=32) (actual time=0.938..0.938 rows=1 loops=1)\r\n   Output: credit_xp('00000000-0000-0000-0000-000000000001'::uuid, 'lesson:completion'::text, 50, 'explain-credit-xp-test'::text, NULL::uuid, NULL::text, '{}'::jsonb)\r\n   Buffers: shared hit=343\r\n Query Identifier: -2722577134236380289\r\n Planning Time: 0.025 ms\r\n Execution Time: 0.953 ms\r\n(6 rows)\r\n\r\n;\r\n🔍 Analyzing get_active_xp_sources function...\r\n==============================================;\r\n                                         QUERY PLAN                                          \r\n---------------------------------------------------------------------------------------------\r\n ProjectSet  (cost=0.00..5.27 rows=1000 width=32) (actual time=0.190..0.218 rows=24 loops=1)\r\n   Output: get_active_xp_sources(now())\r\n   Buffers: shared hit=2\r\n   ->  Result  (cost=0.00..0.01 rows=1 width=0) (actual time=0.001..0.001 rows=1 loops=1)\r\n Query Identifier: -1125711535403011146\r\n Planning Time: 0.025 ms\r\n Execution Time: 0.246 ms\r\n(7 rows)\r\n\r\n;\r\n🔍 Analyzing compute_level_info function...\r\n===========================================;\r\n                                         QUERY PLAN                                         \r\n--------------------------------------------------------------------------------------------\r\n ProjectSet  (cost=0.00..5.27 rows=1000 width=32) (actual time=0.315..0.320 rows=1 loops=1)\r\n   Output: compute_level_info(150)\r\n   Buffers: shared hit=4\r\n   ->  Result  (cost=0.00..0.01 rows=1 width=0) (actual time=0.001..0.001 rows=1 loops=1)\r\n Query Identifier: -6337873644889589703\r\n Planning Time: 0.022 ms\r\n Execution Time: 0.344 ms\r\n(7 rows)\r\n\r\n;\r\n🔍 Skipping unlock_achievement analysis (schema mismatch issue)...\r\n====================================================================;\r\n;\r\n📊 Index Usage Analysis;\r\n========================;\r\n schemaname |     tablename     |                            indexname                            | scans | tuples_read | tuples_fetched \r\n------------+-------------------+-----------------------------------------------------------------+-------+-------------+----------------\r\n public     | level_definitions | ix_level_definitions_level_xp_required                          |  2381 |        2382 |           2381\r\n public     | level_definitions | level_definitions_pkey                                          |   164 |         684 |            684\r\n public     | level_definitions | idx_level_definitions_xp_required                               |     0 |           0 |              0\r\n public     | level_definitions | uq_xp_required                                                  |     0 |           0 |              0\r\n public     | level_definitions | uq_level                                                        |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_user_id                                            |  1536 |       85020 |           1533\r\n public     | profiles          | profiles_pkey                                                   |   145 |         382 |            112\r\n public     | profiles          | idx_profiles_created_at                                         |    64 |          64 |             64\r\n public     | profiles          | profiles_email_key                                              |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_admin                                              |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_xp_level                                           |     0 |           0 |              0\r\n public     | profiles          | idx_profiles_email                                              |     0 |           0 |              0\r\n public     | user_achievements | idx_user_achievements_user_id                                   |     6 |          19 |             17\r\n public     | user_achievements | user_achievements_pkey                                          |     2 |           0 |              0\r\n public     | user_achievements | user_achievements_user_id_achievement_type_achievement_name_key |     0 |           0 |              0\r\n public     | user_achievements | ux_ua_user_ach_ver_scope                                        |     0 |           0 |              0\r\n public     | user_achievements | idx_user_achievements_user_type                                 |     0 |           0 |              0\r\n public     | user_achievements | idx_user_achievements_type                                      |     0 |           0 |              0\r\n public     | xp_events         | uk_xp_events_idempotency                                        |  1260 |         591 |            184\r\n public     | xp_events         | xp_events_pkey                                                  |    12 |          22 |             12\r\n public     | xp_events         | idx_xp_events_user_aggregates                                   |     2 |           2 |              0\r\n public     | xp_events         | idx_xp_events_user_created                                      |     1 |         174 |            162\r\n public     | xp_events         | idx_xp_events_source_stats                                      |     0 |           0 |              0\r\n public     | xp_events         | idx_xp_events_source_type                                       |     0 |           0 |              0\r\n public     | xp_events         | idx_xp_events_created_at                                        |     0 |           0 |              0\r\n public     | xp_sources        | uq_xp_sources_type_action_version                               |    96 |          92 |             88\r\n public     | xp_sources        | ex_xp_sources_active_overlap                                    |     6 |          24 |              4\r\n public     | xp_sources        | xp_sources_pkey                                                 |     5 |          36 |             36\r\n public     | xp_sources        | idx_xp_sources_active_type                                      |     3 |          30 |             20\r\n public     | xp_sources        | idx_xp_sources_active                                           |     0 |           0 |              0\r\n(30 rows)\r\n\r\n;\r\n📊 Table Statistics;\r\n===================;\r\n schemaname |     tablename     | seq_scan | seq_tup_read | idx_scan | idx_tup_fetch | inserts | updates | deletes | live_tuples | dead_tuples \r\n------------+-------------------+----------+--------------+----------+---------------+---------+---------+---------+-------------+-------------\r\n public     | level_definitions |     2697 |        37753 |     2545 |          3065 |      15 |      10 |       0 |          14 |          11\r\n public     | profiles          |    25099 |        24113 |     1745 |          1709 |      20 |    1323 |       0 |           5 |         162\r\n public     | user_achievements |     2341 |         6887 |        8 |            17 |      11 |       4 |       3 |           3 |          12\r\n public     | xp_events         |     3557 |        18524 |     1275 |           360 |    1106 |      15 |     811 |         169 |         163\r\n public     | xp_sources        |     1040 |         9146 |      110 |           148 |      47 |     170 |      22 |          24 |          30\r\n(5 rows)\r\n\r\n;\r\n🔧 Query Plan Cache Stats;\r\n==========================;\r\n funcname | calls | total_time | mean_time | self_time \r\n----------+-------+------------+-----------+-----------\r\n(0 rows)\r\n\r\n;\r\n💾 Buffer Cache Analysis;\r\n========================;\r\n",
  "stderr": "psql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:114: ERROR:  column s.heap_blks_read does not exist\r\nLINE 4:   coalesce(s.heap_blks_read, 0) as heap_read,\r\n                   ^\r\npsql:C:/GitHub/ai_foundations_lms/scripts/p10/collect_explain.sql:114: STATEMENT:  SELECT \r\n  c.relname,\r\n  pg_size_pretty(pg_total_relation_size(c.oid)) as size,\r\n  coalesce(s.heap_blks_read, 0) as heap_read,\r\n  coalesce(s.heap_blks_hit, 0) as heap_hit,\r\n  CASE \r\n    WHEN (coalesce(s.heap_blks_read, 0) + coalesce(s.heap_blks_hit, 0)) > 0\r\n    THEN round((coalesce(s.heap_blks_hit, 0) * 100.0) / (coalesce(s.heap_blks_read, 0) + coalesce(s.heap_blks_hit, 0)), 2)\r\n    ELSE 0 \r\n  END as cache_hit_ratio\r\nFROM pg_class c\r\nLEFT JOIN pg_stat_user_tables s ON c.oid = s.relid\r\nWHERE c.relname IN ('xp_events', 'profiles', 'xp_sources', 'user_achievements', 'level_definitions')\r\nORDER BY c.relname;\r\n"
}